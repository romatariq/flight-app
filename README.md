# Flight schedules app

App displays airports arrival/departure times with additional information.
Such as accurate flight times (based on aircraft's current location), gate, terminal, CO2 and trip length comparison to other transports.

Users can track flights, set notifications about flight states and receive them via e-mail.
Can see statistics about their tracked flights and about airports' flights.
Can post reviews/recommendations about airports and upvote/downvote them.

### Demo
In [short demo video](https://www.youtube.com/watch?v=7RwGP3eduZs) backend and frontend are hosted as separate App services using docker images and DB is hosted with Azure Database for PostgreSQL flexible server.

## Structure

### Backend
Backend is written in C# with .NET Core 7.0. It uses Entity Framework Core with PostgreSQL database.

App has 5 layers: DB, Domain, Repositories/DAL, Services/BLL and Api controller.
Objects are mapped between each layer with AutoMapper (each layer uses their own DTO). Api controllers return versioned public DTOs. 

Api documentation is generated by Swagger.
App uses JWT authentication. There are 2 types of users: admin and user. Admin can accept/remove users verification (unverified users cannot login). Users can manage their tracked flights and posts. Currently non-users (guests) can only see airports statistics and posts.

There are some unit and integration tests.

Flight data fetching has 2 implementations: API (preferred but a lot less accurate) and Web scraping (slower and not actually allowed by FR24). In API implementation, data is fetched from [AirLabs](https://airlabs.co/) API and [OpenSky Network](https://opensky-network.org/). In Web scraping implementation, data is scraped with Puppeteer Sharp from [Flightradar24](https://www.flightradar24.com/) and [ADS-B Exchange](https://globe.adsbexchange.com/), using local browser in development and [Browserless](https://www.browserless.io/) in production. Data is stored in DB and updated whenever requested and it's been more than X time from last update.


### Frontend
Frontend is written in React with TypeScript. There's also partial implementation in Vue3.

Flight details page can direct user to see aircraft's live location and seating plan.


## Setup

### server/.env
~~~text
DOTENV_EMAIL_USERNAME=email@foo.bar
DOTENV_EMAIL_PASSWORD=foobar
DOTENV_AIRLABS_API_KEY=foobar
DOTENV_BROWSERLESS_KEY=foobar
# url must not end with /
DOTENV_FRONTEND_URL=foobar
~~~

### Docker commands
Can run DB, backend and frontend with docker-compose. When running frontend container, used backend url may not be accurate since it's taken from .env.production and built into code.
~~~bash
# build - docker build -t [name:tag] [path]
docker build -t js-22-23 .
docker build -t icd0021-22-23-s-distributed-app .

# run - docker run --name [containerName] --rm -it -p [external:internal] [imageName]
docker run --name js-22-23 --rm -it -p 8001:80 js-22-23
docker run --name icd0021-22-23-s-distributed-app --rm -it -p 8000:80 icd0021-22-23-s-distributed-app

# tag - docker tag [imageName] [userName/newImageName:tag]
docker tag js-22-23 romatariq/js-22-23:latest
docker tag icd0021-22-23-s-distributed-app romatariq/icd0021-22-23-s-distributed-app:latest

# push - docker push [userName/newImageName:tag]
docker push romatariq/js-22-23:latest
docker push romatariq/icd0021-22-23-s-distributed-app:latest
~~~